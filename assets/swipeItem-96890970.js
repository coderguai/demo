import{aB as Se,aC as ye,q as s,p as Ie,d as re,c as x,A,s as ee,av as be,t as G,a as ne,o as z,b as Y,h as Pe,e as U,n as X,y as H,F as Ee,S as ke,j as Ce,P as K,z as ze,aw as Ye,l as te,C as Xe,D as De}from"./index-81730b21.js";import{o as Ne}from"./onWindowResize-9b069d67.js";import{f as Be}from"./avatar-6f500ba1.js";import{u as Ae}from"./icon-4be89cfe.js";function We(e){Se(()=>{e()}),ye(()=>{e()})}function Fe(e,l){if(e>l)return"horizontal";if(l>e)return"vertical"}function Me(){const e=s(0),l=s(0),n=s(0),c=s(0),i=s(0),v=s(0),o=s(0),r=s(0),d=s(0),g=s(0),t=s(),S=s(!1),y=s(!1),b=s(0),P=s(0);let E=null;const D=()=>{e.value=0,l.value=0,n.value=0,c.value=0,i.value=0,v.value=0,o.value=0,r.value=0,d.value=0,g.value=0,t.value=void 0,S.value=!1,y.value=!1,b.value=0,P.value=0};return{startX:e,startY:l,deltaX:n,deltaY:c,offsetX:i,offsetY:v,prevX:o,prevY:r,moveX:d,moveY:g,direction:t,touching:S,dragging:y,startTime:b,distance:P,resetTouch:D,startTouch:k=>{D();const{clientX:p,clientY:T}=k.touches[0];e.value=p,l.value=T,o.value=p,r.value=T,S.value=!0,b.value=performance.now(),y.value=!1,E&&window.cancelAnimationFrame(E)},moveTouch:k=>{const{clientX:p,clientY:T}=k.touches[0];y.value=!0,n.value=p-e.value,c.value=T-l.value,i.value=Math.abs(n.value),v.value=Math.abs(c.value),P.value=Math.sqrt(i.value**2+v.value**2),d.value=p-o.value,g.value=T-r.value,t.value||(t.value=Fe(i.value,v.value)),o.value=p,r.value=T},endTouch:()=>{S.value=!1,E=window.requestAnimationFrame(()=>{y.value=!1})}}}var ue=Symbol("SWIPE_BIND_SWIPE_ITEM_KEY");function $e(){var{childProviders:e,length:l,bindChildren:n}=Ae(ue);return{length:l,swipeItems:e,bindSwipeItems:n}}var qe={loop:{type:Boolean,default:!0},autoplay:[String,Number],duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:String,vertical:Boolean,touchable:{type:Boolean,default:!0},onChange:Ie()};function ae(e,l,n,c,i,v,o){try{var r=e[v](o),d=r.value}catch(g){n(g);return}r.done?l(d):Promise.resolve(d).then(c,i)}function I(e){return function(){var l=this,n=arguments;return new Promise(function(c,i){var v=e.apply(l,n);function o(d){ae(v,c,i,o,r,"next",d)}function r(d){ae(v,c,i,o,r,"throw",d)}o(void 0)})}}var Le=250,Ve=20,{n:Re,classes:Ge}=ne("swipe"),Ke=["onClick"];function Ue(e,l){return z(),Y("div",{class:X(e.n()),ref:"swipeEl"},[Pe("div",{class:X(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:H({width:e.vertical?void 0:e.trackSize+"px",height:e.vertical?e.trackSize+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.trackTranslate+"px)",transitionDuration:e.lockDuration?"0ms":e.toNumber(e.duration)+"ms"}),onTouchstart:l[0]||(l[0]=function(){return e.handleTouchstart&&e.handleTouchstart(...arguments)}),onTouchmove:l[1]||(l[1]=function(){return e.handleTouchmove&&e.handleTouchmove(...arguments)}),onTouchend:l[2]||(l[2]=function(){return e.handleTouchend&&e.handleTouchend(...arguments)})},[U(e.$slots,"default")],38),U(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(z(),Y("div",{key:0,class:X(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(z(!0),Y(Ee,null,ke(e.length,(n,c)=>(z(),Y("div",{class:X(e.classes(e.n("indicator"),[e.index===c,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:H({background:e.indicatorColor}),key:n,onClick:i=>e.to(c)},null,14,Ke))),128))],2)):Ce("v-if",!0)])],2)}var le=re({name:"VarSwipe",props:qe,setup(e){var l=s(null),n=s(0),c=x(()=>e.vertical),i=s(0),v=s(0),o=s(!1),r=s(0),{swipeItems:d,bindSwipeItems:g,length:t}=$e(),{popup:S,bindPopup:y}=Be(),{deltaX:b,deltaY:P,moveX:E,moveY:D,offsetX:O,offsetY:j,touching:W,direction:k,startTime:p,startTouch:T,moveTouch:se,endTouch:fe}=Me(),J=x(()=>k.value===(e.vertical?"vertical":"horizontal")),Q=!1,F=-1,w=a=>d.find(u=>{var{index:f}=u;return f.value===a}),ce=()=>{e.loop&&(v.value>=0&&w(t.value-1).setTranslate(-i.value),v.value<=-(i.value-n.value)&&w(0).setTranslate(i.value),v.value>-(i.value-n.value)&&v.value<0&&(w(t.value-1).setTranslate(0),w(0).setTranslate(0)))},M=a=>{var u=ze(a)?a:Math.floor((v.value-n.value/2)/-n.value),{loop:f}=e;return u<=-1?f?-1:0:u>=t.value?f?t.value:t.value-1:u},de=a=>{var{loop:u}=e;return a===-1?u?t.value-1:0:a===t.value?u?0:t.value-1:a},$=a=>e.loop?a<0?t.value+a:a>=t.value?a-t.value:a:Ye(a,0,t.value-1),q=function(){var a=I(function*(){var u=v.value>=n.value,f=v.value<=-i.value,h=0,m=-(i.value-n.value);o.value=!0,(u||f)&&(o.value=!0,v.value=f?h:m,w(0).setTranslate(0),w(t.value-1).setTranslate(0)),yield K(),o.value=!1});return function(){return a.apply(this,arguments)}}(),L=()=>{Q||(r.value=$(G(e.initialIndex)),Q=!0)},V=()=>{var{autoplay:a}=e;!a||t.value<=1||(N(),F=window.setTimeout(()=>{R(),V()},G(a)))},N=()=>{F&&clearTimeout(F)},Z=a=>{v.value=a,ce()},me=function(){var a=I(function*(u){t.value<=1||!e.touchable||(T(u),N(),yield q(),o.value=!0)});return function(f){return a.apply(this,arguments)}}(),he=a=>{var{touchable:u,vertical:f}=e;!W.value||!u||(se(a),J.value&&(a.preventDefault(),Z(v.value+(f?D.value:E.value))))},pe=()=>{if(W.value&&(fe(),!!J.value)){var{vertical:a,onChange:u}=e,f=a?P.value<0:b.value<0,h=a?j.value:O.value,m=performance.now()-p.value<=Le&&h>=Ve,B=m?M(f?r.value+1:r.value-1):M();o.value=!1,Z(B*-n.value);var ge=r.value;r.value=de(B),V(),ge!==r.value&&A(u,r.value)}},C=()=>{l.value&&(o.value=!0,n.value=e.vertical?l.value.offsetHeight:l.value.offsetWidth,i.value=n.value*t.value,v.value=r.value*-n.value,d.forEach(a=>{a.setTranslate(0)}),V(),setTimeout(()=>{o.value=!1}))},R=function(){var a=I(function*(u){if(!(t.value<=1)){L();var{loop:f,onChange:h}=e,m=r.value;if(r.value=$(m+1),(u==null?void 0:u.event)!==!1&&A(h,r.value),yield q(),m===t.value-1&&f){w(0).setTranslate(i.value),v.value=t.value*-n.value;return}m!==t.value-1&&(v.value=r.value*-n.value)}});return function(f){return a.apply(this,arguments)}}(),_=function(){var a=I(function*(u){if(!(t.value<=1)){L();var{loop:f,onChange:h}=e,m=r.value;if(r.value=$(m-1),(u==null?void 0:u.event)!==!1&&A(h,r.value),yield q(),m===0&&f){w(t.value-1).setTranslate(-i.value),v.value=n.value;return}m!==0&&(v.value=r.value*-n.value)}});return function(f){return a.apply(this,arguments)}}(),Te=(a,u)=>{if(!(t.value<=1||a===r.value)){a=a<0?0:a,a=a>=t.value?t.value:a;var f=a>r.value?R:_,h=Math.abs(a-r.value);Array.from({length:h}).forEach((m,B)=>{f({event:B===h-1?u==null?void 0:u.event:!1})})}},we={size:n,vertical:c};return g(we),A(y,null),ee(()=>t.value,I(function*(){yield K(),L(),C()})),S&&ee(()=>S.show.value,function(){var a=I(function*(u){u?(yield K(),C()):N()});return function(u){return a.apply(this,arguments)}}()),be(C),We(N),Ne(C),{n:Re,classes:Ge,length:t,index:r,swipeEl:l,trackSize:i,trackTranslate:v,lockDuration:o,handleTouchstart:me,handleTouchmove:he,handleTouchend:pe,next:R,prev:_,to:Te,resize:C,toNumber:G}}});le.render=Ue;const ve=le;te(ve);var xe=ve;function He(){var{bindParent:e,index:l,parentProvider:n}=Xe(ue);return e||De("SwipeItem","<var-swipe-item/> must in <var-swipe/>"),{index:l,swipe:n,bindSwipe:e}}var{n:Oe}=ne("swipe-item");function je(e,l){return z(),Y("div",{class:X(e.n()),style:H({width:e.vertical?void 0:e.size+"px",height:e.vertical?e.size+"px":void 0,transform:"translate"+(e.vertical?"Y":"X")+"("+e.translate+"px)"})},[U(e.$slots,"default")],6)}var ie=re({name:"VarSwipeItem",setup(){var e=s(0),{swipe:l,bindSwipe:n,index:c}=He(),{size:i,vertical:v}=l,o=d=>{e.value=d},r={index:c,setTranslate:o};return n(r),{n:Oe,size:i,vertical:v,translate:e}}});ie.render=je;const oe=ie;te(oe);var ea=oe;export{oe as S,ea as _,ve as a,xe as b,We as o,Me as u};
